<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æœ¬åœ°é è¦½PDFç‰ˆ</title>

    <!-- PDF.js å®˜æ–¹ CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/web/pdf_viewer.css"
    />

    <!-- è‡ªå®šç¾©æ¨£å¼ -->
    <style>
      :root {
        --main-color: #0078d7;
        --button-hover-color: #005a9e;
        --button-active-color: #004275;
      }

      html,
      body {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
      }

      #viewerContainer {
        position: absolute;
        top: 40px; /* å¢åŠ é«˜åº¦çµ¦å·¥å…·åˆ— */
        bottom: 0;
        left: 0;
        right: 0;
        overflow: auto;
        background-color: #525659;
      }

      #viewer {
        position: relative;
      }

      .toolbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 40px;
        background-color: #474747;
        color: white;
        display: flex;
        align-items: center;
        padding: 0 10px;
        z-index: 1000;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      }

      .toolbar-left,
      .toolbar-center,
      .toolbar-right {
        display: flex;
        align-items: center;
      }

      .toolbar-left {
        flex: 1.5; /* å¢åŠ ç©ºé–“çµ¦æª”æ¡ˆä¸Šå‚³æŒ‰éˆ• */
      }

      .toolbar-center {
        flex: 1;
        justify-content: center;
      }

      .toolbar-right {
        flex: 1;
        justify-content: flex-end;
      }

      .toolbar button,
      .toolbar label.btn {
        background-color: transparent;
        border: none;
        color: white;
        padding: 6px 10px;
        margin: 0 2px;
        cursor: pointer;
        border-radius: 2px;
        font-size: 14px;
        display: inline-flex;
        align-items: center;
      }

      .toolbar label.btn {
        background-color: var(--main-color);
        margin-right: 15px;
      }

      .toolbar button:hover,
      .toolbar label.btn:hover {
        background-color: var(--button-hover-color);
      }

      .toolbar button:active,
      .toolbar label.btn:active {
        background-color: var(--button-active-color);
      }

      /* éš±è—åŸç”Ÿæª”æ¡ˆè¼¸å…¥æ¡† */
      #fileInput {
        display: none;
      }

      .page-controls {
        display: flex;
        align-items: center;
      }

      #pageNumber {
        width: 40px;
        text-align: center;
        background-color: #333;
        color: white;
        border: 1px solid #555;
        border-radius: 2px;
        padding: 3px;
        margin: 0 5px;
      }

      .zoom-controls {
        display: flex;
        align-items: center;
        margin: 0 10px;
      }

      #zoomValue {
        margin: 0 5px;
        min-width: 45px;
        text-align: center;
      }

      #loadingBar {
        position: absolute;
        top: 40px;
        left: 0;
        width: 100%;
        height: 4px;
        background-color: rgba(0, 0, 0, 0.3);
        z-index: 1001;
        display: none;
      }

      #loadingBar .progress {
        width: 0%;
        height: 100%;
        background-color: var(--main-color);
        transition: width 0.2s;
      }

      #viewerContainer {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media print {
        /* éš±è—æ‰€æœ‰é é¢å…§å®¹ */
        .toolbar,
        #viewerContainer,
        #loadingBar {
          display: none !important;
        }

        /* é¡¯ç¤ºåˆ—å°é®è”½å±¤ */
        #print-overlay {
          display: flex !important;
        }

        /* ä¿®æ­£ï¼šåˆ—å°æ™‚å¼·åˆ¶ç§»é™¤æ¨¡ç³Šæ¿¾é¡ï¼Œé¿å…é®è”½å±¤ä¹Ÿè¢«æ¨¡ç³Š */
        body.blurred {
          filter: none !important;
          -webkit-filter: none !important;
        }
      }

      /* åˆ—å°é®è”½å±¤æ¨£å¼ */
      #print-overlay {
        display: none; /* å¹³æ™‚éš±è— */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: white;
        z-index: 9999;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .print-warning .icon {
        font-size: 80px;
        margin-bottom: 20px;
      }

      .print-warning h1 {
        color: #d32f2f; /* ç´…è‰²è­¦å‘Š */
        font-size: 32px;
        margin: 0;
        font-weight: bold;
      }

      .print-warning p {
        color: #555;
        font-size: 18px;
        margin-top: 10px;
      }

      /* è¦–çª—å¤±å»ç„¦é»æ™‚çš„æ¨¡ç³Šæ•ˆæœ */
      .blurred {
        /* ä½¿ç”¨é«˜æ–¯æ¨¡ç³Š + é™ä½äº®åº¦ (æ¨¡æ“¬æ·±è‰²æ¯›ç»ç’ƒæ•ˆæœï¼Œé¿å…åˆºçœ¼) */
        filter: blur(20px) brightness(0.6);
        -webkit-filter: blur(20px) brightness(0.6);
        pointer-events: none; /* é˜²æ­¢åœ¨æ¨¡ç³Šç‹€æ…‹ä¸‹è¢«é»æ“Š */
        transition: filter 0.3s ease; /* å¢åŠ éæ¸¡æ™‚é–“è®“æ•ˆæœæ›´æŸ”å’Œ */
      }

      /* å¯†ç¢¼è¼¸å…¥å°è©±æ¡†æ¨£å¼ */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background-color: #3a3a3a;
        color: white;
        padding: 20px 30px;
        border-radius: 4px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        min-width: 300px;
        text-align: center;
      }

      .modal-content h3 {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 18px;
      }

      .modal-content p {
        margin-bottom: 15px;
        font-size: 14px;
        color: #ddd;
      }

      .password-input-container {
        position: relative;
        width: 100%;
        margin-bottom: 20px;
      }

      .modal-content input#modalPasswordInput {
        width: 100%;
        padding: 8px;
        padding-right: 35px; /* ç‚ºçœ¼ç›åœ–ç¤ºç•™ç©ºé–“ */
        border: 1px solid #555;
        border-radius: 2px;
        background-color: #222;
        color: white;
        box-sizing: border-box;
      }

      .modal-content input#modalPasswordInput:focus {
        outline: none;
        border-color: var(--main-color);
      }

      .modal-content input#modalPasswordInput.error {
        border-color: #f44336;
      }

      .error-text {
        color: #ff5252 !important;
        font-weight: bold;
      }

      .toggle-password {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        user-select: none;
        font-size: 18px;
        opacity: 0.8;
        transition: all 0.2s ease;
      }

      .toggle-password:hover {
        opacity: 1;
        transform: translateY(-50%) scale(1.2);
      }

      .toggle-password:active {
        transform: translateY(-50%) scale(0.9);
      }

      .modal-buttons {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .modal-buttons button {
        padding: 6px 15px;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        font-size: 14px;
      }

      .btn-cancel {
        background-color: #555;
        color: white;
      }

      .btn-cancel:hover {
        background-color: #666;
      }

      .btn-confirm {
        background-color: var(--main-color);
        color: white;
      }

      .btn-confirm:hover {
        background-color: var(--button-hover-color);
      }
    </style>
  </head>
  <body>
    <div class="toolbar">
      <div class="toolbar-left">
        <!-- æ–°å¢ï¼šæª”æ¡ˆé¸å–æŒ‰éˆ• -->
        <label for="fileInput" class="btn" title="é–‹å•Ÿæœ¬åœ° PDF æª”æ¡ˆ">
          <span>ğŸ“‚ é–‹å•Ÿ PDF</span>
        </label>
        <input type="file" id="fileInput" accept=".pdf" />

        <div class="page-controls">
          <button id="previous" title="ä¸Šä¸€é ">â—€</button>
          <input type="number" id="pageNumber" min="1" value="1" />
          <span>/</span>
          <span id="numPages">0</span>
          <button id="next" title="ä¸‹ä¸€é ">â–¶</button>
        </div>
      </div>

      <div class="toolbar-center">
        <div class="zoom-controls">
          <button id="zoomOut" title="ç¸®å°">ï¼</button>
          <span id="zoomValue">100%</span>
          <button id="zoomIn" title="æ”¾å¤§">ï¼‹</button>
        </div>
      </div>

      <div class="toolbar-right">
        <button id="print" title="åˆ—å°">åˆ—å°</button>
        <button id="download" title="ä¸‹è¼‰">ä¸‹è¼‰</button>
      </div>
    </div>

    <div id="loadingBar">
      <div class="progress"></div>
    </div>

    <div id="viewerContainer">
      <div id="viewer" class="pdfViewer"></div>
    </div>

    <!-- åˆ—å°é®è”½å±¤ (é è¨­éš±è—ï¼Œåƒ…åˆ—å°æ™‚é¡¯ç¤º) -->
    <div id="print-overlay">
      <div class="print-warning">
        <div class="icon">ğŸš«</div>
        <h1>æ©Ÿå¯†æ–‡ä»¶ ç¦æ­¢åˆ—å°</h1>
        <p>Confidential - Printing Prohibited</p>
      </div>
    </div>

    <!-- å¯†ç¢¼è¼¸å…¥å°è©±æ¡† -->
    <div id="passwordModal" class="modal-overlay">
      <div class="modal-content">
        <h3>æ–‡ä»¶å—ä¿è­·</h3>
        <p id="passwordPromptMsg">è«‹è¼¸å…¥å¯†ç¢¼ä»¥é–‹å•Ÿæ­¤æ–‡ä»¶ï¼š</p>
        <div class="password-input-container">
          <input
            type="password"
            id="modalPasswordInput"
            placeholder="è«‹è¼¸å…¥å¯†ç¢¼"
          />
          <span id="togglePassword" class="toggle-password" title="é¡¯ç¤ºå¯†ç¢¼">ğŸ‘€</span>
        </div>
        <div class="modal-buttons">
          <button id="modalCancelBtn" class="btn-cancel">å–æ¶ˆ</button>
          <button id="modalConfirmBtn" class="btn-confirm">ç¢ºèª</button>
        </div>
      </div>
    </div>

    <!-- PDF.js å®˜æ–¹ JS -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/web/pdf_viewer.js"></script>

    <script>
      // è¨­å®š PDF.js çš„ worker è·¯å¾‘
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';

      // è®Šæ•¸å®šç¾©
      let pdfDoc = null;
      let pageNum = 1;
      let scale = 1.0;
      let pdfViewer = null;
      let pdfLinkService = null;
      let currentPdfData = null; // å„²å­˜ç•¶å‰ PDF è³‡æ–™

      // DOM å…ƒç´ 
      const container = document.getElementById('viewerContainer');
      const pageNumberInput = document.getElementById('pageNumber');
      const numPages = document.getElementById('numPages');
      const previousButton = document.getElementById('previous');
      const nextButton = document.getElementById('next');
      const zoomInButton = document.getElementById('zoomIn');
      const zoomOutButton = document.getElementById('zoomOut');
      const zoomValueSpan = document.getElementById('zoomValue');
      const printButton = document.getElementById('print');
      const downloadButton = document.getElementById('download');
      const loadingBar = document.getElementById('loadingBar');
      const loadingBarProgress = loadingBar.querySelector('.progress');
      const fileInput = document.getElementById('fileInput');

      // å¯†ç¢¼ Modal å…ƒç´ 
      const passwordModal = document.getElementById('passwordModal');
      const modalPasswordInput = document.getElementById('modalPasswordInput');
      const modalConfirmBtn = document.getElementById('modalConfirmBtn');
      const modalCancelBtn = document.getElementById('modalCancelBtn');
      const passwordPromptMsg = document.getElementById('passwordPromptMsg');
      const togglePassword = document.getElementById('togglePassword');

      let currentPasswordCallback = null; // æš«å­˜å¯†ç¢¼å›èª¿å‡½å¼
      // äº‹ä»¶åŒ¯æµæ’ï¼Œå¯ä»¥å…¨åŸŸå…±ç”¨
      let eventBus = null;

      // åˆå§‹åŒ– PDF åŸºç¤å…ƒä»¶ (åªåŸ·è¡Œä¸€æ¬¡)
      function initApp() {
        eventBus = new pdfjsViewer.EventBus();
        // ç›£è½äº‹ä»¶
        eventBus.on('pagechanging', function (evt) {
          pageNum = evt.pageNumber;
          updateUI();
        });

        eventBus.on('scalechanging', function (evt) {
          scale = evt.scale;
          updateZoomValue();
        });

        eventBus.on('progress', function (evt) {
          if (evt.total > 0) {
            const percent = Math.round((evt.loaded / evt.total) * 100);
            loadingBarProgress.style.width = percent + '%';
          }
        });

        eventBus.on('documentloaded', function () {
          loadingBar.style.display = 'none';
        });
      }

      // å»ºç«‹ä¸¦è¨­å®š Viewer (æ¯æ¬¡è¼‰å…¥æ–°æª”æ™‚å‘¼å«)
      function createPdfViewer() {
        // æ¸…ç©ºå®¹å™¨
        container.textContent = '';
        const viewerDiv = document.createElement('div');
        viewerDiv.id = 'viewer';
        viewerDiv.className = 'pdfViewer';
        container.appendChild(viewerDiv);

        // é‡å»º LinkService å’Œ FindController
        pdfLinkService = new pdfjsViewer.PDFLinkService({
          eventBus: eventBus,
        });

        const findController = new pdfjsViewer.PDFFindController({
          eventBus: eventBus,
          linkService: pdfLinkService,
        });

        pdfViewer = new pdfjsViewer.PDFViewer({
          container: container,
          eventBus: eventBus,
          linkService: pdfLinkService,
          findController: findController,
          renderer: 'canvas',
          textLayerMode: 2,
        });

        pdfLinkService.setViewer(pdfViewer);
      }

      /**
       * è¼‰å…¥ PDF
       * @param {string|Uint8Array} source - æª”æ¡ˆè·¯å¾‘ URL æˆ– ArrayBuffer è³‡æ–™
       */
      function loadPdf(source) {
        loadingBar.style.display = 'block';
        loadingBarProgress.style.width = '0%';

        // å„²å­˜ä¾†æºä»¥ä¾¿ (æœªä¾†å¯èƒ½çš„) ä½¿ç”¨
        if (typeof source !== 'string') {
          currentPdfData = source;
        } else {
          currentPdfData = null;
        }

        // æº–å‚™è¼‰å…¥åƒæ•¸ï¼ŒåŒ…å«å¯†ç¢¼è™•ç†
        const params = {};
        if (typeof source === 'string') {
          params.url = source;
        } else {
          params.data = source;
        }

        const loadingTask = pdfjsLib.getDocument(params);

        loadingTask.onPassword = function (updatePassword, reason) {
          console.log('éœ€è¦å¯†ç¢¼ï¼ŒåŸå› ä»£ç¢¼:', reason);

          // å„²å­˜å›èª¿ä»¥ä¾¿ Modal ä½¿ç”¨
          currentPasswordCallback = updatePassword;
          let msg = 'è«‹è¼¸å…¥å¯†ç¢¼ä»¥é–‹å•Ÿæ­¤æ–‡ä»¶ï¼š';

          // å˜—è©¦å–å¾—éŒ¯èª¤ä»£ç¢¼å¸¸æ•¸ï¼Œè‹¥ç„¡æ³•å–å¾—å‰‡é è¨­ç‚º 1 (é€šå¸¸æ˜¯å¯†ç¢¼éŒ¯èª¤)
          const PASSWORD_INCORRECT =
            (pdfjsLib.PasswordResponses &&
              pdfjsLib.PasswordResponses.INCORRECT_PASSWORD) ||
            1;
          if (reason === PASSWORD_INCORRECT) {
            msg = 'å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ï¼š';
            modalPasswordInput.value = ''; // éŒ¯èª¤æ™‚æ¸…ç©º
            modalPasswordInput.classList.add('error');
            passwordPromptMsg.classList.add('error-text');
          } else {
            modalPasswordInput.value = ''; // é¦–æ¬¡è¼¸å…¥æ¸…ç©º
            modalPasswordInput.classList.remove('error');
            passwordPromptMsg.classList.remove('error-text');
          }
          passwordPromptMsg.textContent = msg;
          passwordModal.style.display = 'flex';
          modalPasswordInput.focus();
        };

        loadingTask.promise
          .then(function (pdf) {
            // åœ¨è¨­å®šæ–°æ–‡ä»¶å‰ï¼ŒéŠ·æ¯€èˆŠçš„ pdfDoc (å¦‚æœæœ‰çš„è©±)
            if (pdfDoc) {
              pdfDoc.destroy();
              pdfDoc = null;
            }
            // é‡å»º Viewer ç’°å¢ƒ
            createPdfViewer();
            pdfDoc = pdf;
            numPages.textContent = pdf.numPages;
            pdfViewer.setDocument(pdf);
            pdfLinkService.setDocument(pdf);

            // é‡ç½®ç¸®æ”¾
            scale = 1.0;
            pdfViewer.currentScaleValue = 'auto';

            updateUI();
            // æˆåŠŸè¼‰å…¥å¾Œéš±è— Modal
            passwordModal.style.display = 'none';
            currentPasswordCallback = null;
            console.log('PDF è¼‰å…¥æˆåŠŸ');
          })
          .catch(function (error) {
            console.error('è¼‰å…¥ PDF å¤±æ•—:', error);

            // å¤±æ•—ä¹Ÿè¦éš±è— Modal
            passwordModal.style.display = 'none';
            currentPasswordCallback = null;
            let msg = 'è¼‰å…¥å¤±æ•—: ' + error.message;
            if (
              typeof source === 'string' &&
              window.location.protocol === 'file:'
            ) {
              msg +=
                '\n\næ³¨æ„ï¼šç”±æ–¼ç€è¦½å™¨å®‰å…¨æ€§é™åˆ¶ (CORS)ï¼Œç›´æ¥é–‹å•Ÿ HTML æª”æ¡ˆæ™‚é€šå¸¸ç„¡æ³•è®€å–åŒç›®éŒ„çš„å…¶ä»–æª”æ¡ˆã€‚\nè«‹ä½¿ç”¨å·¦ä¸Šè§’çš„ã€Œé–‹å•Ÿ PDFã€æŒ‰éˆ•é¸å–æª”æ¡ˆã€‚';
            }
            alert(msg);
            loadingBar.style.display = 'none';
          });
      }

      // Modal äº‹ä»¶è™•ç†
      function submitPassword() {
        const password = modalPasswordInput.value;
        if (currentPasswordCallback) {
          // éš±è— Modal äº¤çµ¦ PDF.js è™•ç†é©—è­‰ (å¦‚æœéŒ¯èª¤ onPassword æœƒå†æ¬¡è¢«å‘¼å«)
          passwordModal.style.display = 'none';
          currentPasswordCallback(password);
        }
      }

      function cancelPassword() {
        if (currentPasswordCallback) {
          // å‚³å…¥ç©ºå­—ä¸²æˆ–å–æ¶ˆ
          console.log('ä½¿ç”¨è€…å–æ¶ˆè¼¸å…¥å¯†ç¢¼');
          currentPasswordCallback('');
        }
        passwordModal.style.display = 'none';
        loadingBar.style.display = 'none';
      }

      modalConfirmBtn.addEventListener('click', submitPassword);
      modalCancelBtn.addEventListener('click', cancelPassword);

      // å¯†ç¢¼é¡¯ç¤º/éš±è—åˆ‡æ›
      function showPassword() {
        modalPasswordInput.type = 'text';
      }

      function hidePassword() {
        modalPasswordInput.type = 'password';
      }

      togglePassword.addEventListener('mousedown', showPassword);
      togglePassword.addEventListener('mouseup', hidePassword);
      togglePassword.addEventListener('mouseleave', hidePassword);

      // è¡Œå‹•è£ç½®æ”¯æ´
      togglePassword.addEventListener('touchstart', function (e) {
        e.preventDefault();
        showPassword();
      });
      togglePassword.addEventListener('touchend', function (e) {
        e.preventDefault();
        hidePassword();
      });

      // æ”¯æ´ Enter éµæäº¤
      modalPasswordInput.addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
          submitPassword();
        } else if (e.key === 'Escape') {
          cancelPassword();
        }
      });

      function updateUI() {
        pageNumberInput.value = pageNum;
        previousButton.disabled = pageNum <= 1;
        nextButton.disabled = pageNum >= pdfDoc.numPages;
      }

      function updateZoomValue() {
        zoomValueSpan.textContent = Math.round(scale * 100) + '%';
      }

      // æŒ‰éˆ•äº‹ä»¶è™•ç†
      function onPrevPage() {
        if (pageNum > 1) {
          pageNum--;
          pdfViewer.currentPageNumber = pageNum;
        }
      }

      function onNextPage() {
        if (pageNum < pdfDoc.numPages) {
          pageNum++;
          pdfViewer.currentPageNumber = pageNum;
        }
      }

      function onZoomIn() {
        scale = Math.min(5, scale * 1.1);
        pdfViewer.currentScale = scale;
      }

      function onZoomOut() {
        scale = Math.max(0.1, scale / 1.1);
        pdfViewer.currentScale = scale;
      }

      function onPrint() {
        alert('æœ¬ç³»çµ±å·²ç¦ç”¨åˆ—å°åŠŸèƒ½ã€‚');
      }

      function onDownload() {
        alert('æœ¬ç³»çµ±å·²ç¦ç”¨ä¸‹è¼‰åŠŸèƒ½ã€‚');
      }

      // ç›£è½æª”æ¡ˆé¸å–
      fileInput.addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (file) {
          const fileReader = new FileReader();
          fileReader.onload = function () {
            const typedarray = new Uint8Array(this.result);
            loadPdf(typedarray);
          };
          fileReader.readAsArrayBuffer(file);
        }
      });

      // ç¶å®šæŒ‰éˆ•äº‹ä»¶
      previousButton.addEventListener('click', onPrevPage);
      nextButton.addEventListener('click', onNextPage);
      zoomInButton.addEventListener('click', onZoomIn);
      zoomOutButton.addEventListener('click', onZoomOut);
      printButton.addEventListener('click', onPrint);
      downloadButton.addEventListener('click', onDownload);

      pageNumberInput.addEventListener('change', function () {
        const val = parseInt(this.value);
        if (val >= 1 && val <= pdfDoc.numPages) {
          pageNum = val;
          pdfViewer.currentPageNumber = pageNum;
        } else {
          this.value = pageNum;
        }
      });

      // ç¦ç”¨å³éµé¸å–®
      document.addEventListener('contextmenu', (e) => e.preventDefault());

      // ç¦ç”¨éµç›¤å¿«æ·éµ (Ctrl+P, Ctrl+S)
      document.addEventListener('keydown', function (e) {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'p' || e.key === 'P')) {
          e.preventDefault();
          alert('æœ¬ç³»çµ±å·²ç¦ç”¨åˆ—å°åŠŸèƒ½ã€‚');
        }
        if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S')) {
          e.preventDefault();
          alert('æœ¬ç³»çµ±å·²ç¦ç”¨å„²å­˜åŠŸèƒ½ã€‚');
        }
      });

      // è¦–çª—å¤±å»ç„¦é»æ™‚æ¨¡ç³ŠåŒ–å…§å®¹ (é˜²æˆªåœ–è»Ÿé«”)
      window.addEventListener('blur', function () {
        document.body.classList.add('blurred');
        document.title = 'å…§å®¹ä¿è­·ä¸­...';
      });

      window.addEventListener('focus', function () {
        document.body.classList.remove('blurred');
        document.title = 'æœ¬åœ°é è¦½PDFç‰ˆ';
      });

      // åˆå§‹åŒ–
      initApp();
      createPdfViewer();

      // å˜—è©¦è‡ªå‹•è¼‰å…¥åŒç›®éŒ„ä¸‹çš„ report.pdf
      //loadPdf('report.pdf');
    </script>
  </body>
</html>
